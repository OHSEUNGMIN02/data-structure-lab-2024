# -*- coding: utf-8 -*-
"""ì „ë´‡ëŒ€ í”„ë¡œì íŠ¸ 1.

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1W3S4AAkux2Il6mmm6zgGkfzQS25_hkWP
"""

# âœ… STEP 1: YOLOv8 ì„¤ì¹˜
!pip install -q ultralytics

# âœ… STEP 2: íŒŒì¼ ì—…ë¡œë“œ (ì§ì ‘ ì´ë¯¸ì§€ ì„ íƒ)
from google.colab import files
uploaded = files.upload()

# âœ… STEP 3: ê²½ë¡œ í™•ì¸
import os

# ì—…ë¡œë“œí•œ íŒŒì¼ëª… ì–»ê¸°
uploaded_filename = next(iter(uploaded))
image_path = os.path.abspath(uploaded_filename)
print("ğŸ“‚ ì´ë¯¸ì§€ ê²½ë¡œ:", image_path)

# âœ… STEP 4: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
from ultralytics import YOLO
import cv2
import matplotlib.pyplot as plt
import pandas as pd

# âœ… STEP 5: YOLOv8 ëª¨ë¸ ë¡œë“œ
model = YOLO("yolov8n.pt")

# âœ… STEP 6: ê°ì²´ ê°ì§€ ì‹¤í–‰
results = model(image_path)

# âœ… STEP 7: ì‹œê°í™”ìš© ì´ë¯¸ì§€ ìƒì„±
result_image = results[0].plot()

# âœ… STEP 8: ê²°ê³¼ ì´ë¯¸ì§€ ì¶œë ¥
plt.figure(figsize=(10, 8))
plt.imshow(cv2.cvtColor(result_image, cv2.COLOR_BGR2RGB))
plt.axis('off')
plt.title("YOLOv8 Object Detection Result")
plt.show()

# âœ… STEP 9: ê°ì§€ëœ ê°ì²´ ì •ë³´ ì¶”ì¶œ
detected_objects = []
for box in results[0].boxes:
    cls_id = int(box.cls[0])
    label = model.names[cls_id]
    conf = float(box.conf[0])
    xyxy = box.xyxy[0].tolist()
    detected_objects.append({
        "Label": label,
        "Confidence": round(conf, 2),
        "BBox [x1, y1, x2, y2]": [round(x, 1) for x in xyxy]
    })

# âœ… STEP 10: ê°ì²´ ì •ë³´ ì¶œë ¥
pd.DataFrame(detected_objects)